// @ts-ignore
import leafletMap from '../../../leaflet-layer'
import { PointStyles, RasterStyles } from 'leaflet-layer'
import { StandardGrid } from 'leaflet-layer'
const convert = require('xml-js')

// @ts-ignore
const L = window.L

const position = new L.LatLng(31.1953349914293, 121.447382657192)
// var position = new L.LatLng(39.90778, 116.401216)
const map = L.map('map', {
  // crs: L.CRS.EPSG4326
  crs: L.CRS.EPSG3857,
}).setView(position, 13)
L.tileLayer
  .chinaProvider('GaoDe.Normal.Map', { maxZoom: 18, minZoom: 3 })
  .addTo(map)
// const tile = L.tileLayer.wms(
//   'http://192.168.1.54:8090/geoserver/workspace_dev/wms',
//   {
//     layers: 'workspace_dev:t_grid',
//     transparent: true,
//     format: 'image/png',
//     crs: L.CRS.EPSG4326,
//   }
// )

// const json =
//   '[[118.98532735554552,31.401239085033488],[118.98532728679919,31.401238062752544],[118.98525642597194,31.400737309927134],[118.98524136366655,31.400488901998198],[118.98524344313508,31.40043444948575],[118.98525136949847,31.400350271416947],[118.98529217894209,31.400197982460792],[118.98537803763969,31.399921417531893],[118.9855659078832,31.399468760062625],[118.98556597793429,31.399468584981324],[118.98565784924301,31.39923013847729],[118.98570706533121,31.399147649943455],[118.98575515936338,31.399101355745252],[118.98575625095087,31.39910007076249],[118.98575702930184,31.399098627805444],[118.98575746450473,31.399097082326143],[118.9857575398349,31.399095493716487],[118.98575725239755,31.399093923025866],[118.98575661323875,31.39909243061502],[118.98575564692094,31.39909107383647],[118.98575439057926,31.399089904830426],[118.9857528924942,31.399088968521152],[118.98575121023633,31.399088300890476],[118.98574940845381,31.399087927595048],[118.98574755638818,31.399087862980426],[118.98574572521323,31.39908810952969],[118.9857439853,31.39908865776811],[118.98574240351233,31.399089486627172],[118.98574104063745,31.399090564254333],[118.98569214063639,31.39913763425169],[118.98569078275771,31.39913933508741],[118.98564068275181,31.3992233050844],[118.98564012208719,31.39922445502354],[118.98554805592698,31.399463407134498],[118.98536009207841,31.3999162899254],[118.98535986283632,31.39991692305268],[118.98527386281066,31.400193943047675],[118.98527378471022,31.40019421317894],[118.9852327846957,31.400347213176627],[118.98523257508798,31.400348377076035],[118.9852245750795,31.40043333707579],[118.98522454945774,31.40043372447716],[118.98522244945221,31.40048871447724],[118.98522245714601,31.400489401245284],[118.98523755712125,31.400738431247415],[118.98523761324917,31.400738987239585],[118.98530844113333,31.40123950797119],[118.98530734443736,31.401408914966446],[118.98530751588042,31.401410498074398],[118.98530804410697,31.401412022075025],[118.98530890881763,31.401413428401813],[118.98531007678204,31.40141466301044],[118.98531150311597,31.401415678455567],[118.98531313300626,31.401416435714193],[118.9853149038171,31.4014169056853],[118.98531674749718,31.40141707030815],[118.98531859319493,31.40141692325637],[118.98532036998118,31.4014164701811],[118.98532200957501,31.401415728493763],[118.98532344896775,31.401414726696995],[118.98532463284434,31.401413503289277],[118.98532551570909,31.401412105285512],[118.98532606363398,31.401410586410197],[118.98532625556263,31.40140900503286],[118.98532735554552,31.401239085033488]]'
// const latlngs = JSON.parse(json).map(([a, b]) => [b, a])
// L.polygon(latlngs).addTo(map)

const latlngs = [
  [31.1953349914293, 121.447382657192],
  [31.2020068468886, 121.446274438124],
  [31.2020123557601, 121.442947694754],
  [31.2020049117006, 121.44738323504],
  [31.1920019527958, 121.446273571174],
  [31.1953330076833, 121.448491396541],
  [31.1942374131254, 121.43851051735],
  [31.2020205190144, 121.437401913132],
  [31.1942213507426, 121.448491300273],
  [31.1953424355233, 121.442947116313],
  [31.1975621235596, 121.445165197392],
  [31.1975691666719, 121.440729180323],
  [31.203125741233, 121.441838757233],
  [31.1908992220986, 121.440728601706],
  [31.1920091974173, 121.441837792974],
  [31.2031321687832, 121.437402009661],
  [31.2020140914587, 121.441838660789],
  [31.2020008962473, 121.449600656358],
  [31.1920140962528, 121.4385103244],
  [31.2009057583347, 121.43962031383],
  [31.2031274258398, 121.440729662614],
  [31.2053455156508, 121.444056957787],
  [31.1975542868065, 121.449600271324],
  [31.1986756139161, 121.444056379416],
  [31.2008932608849, 121.447383138722],
  [31.190900855186, 121.439619445657],
  [31.1997835442298, 121.44627424544],
  [31.1953309759585, 121.449600078831],
  [31.1997924734223, 121.440729373227],
  [31.1931225409787, 121.440728794562],
]

latlngs.forEach((latlng) => {
  const [lat, lng] = latlng
  L.marker(L.latLng(lat, lng)).addTo(map)
})

const data = latlngs.map((latlng) => {
  const [lat, lng] = latlng
  return {
    geometry: {
      type: 'Point',
      coordinates: [lng, lat],
    },
  }
})
const layer = new StandardGrid(map, data, {}, console.log)
layer.draw()
layer.fitBounds()
